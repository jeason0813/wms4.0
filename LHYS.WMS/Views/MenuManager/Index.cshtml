
@{
    Layout = null;
}

<!DOCTYPE html>

<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link href="~/Content/IntegralUI-TreeViewCheckBox/samples.css" rel="stylesheet" />
    <link href="~/Content/IntegralUI-TreeViewCheckBox/integralui.css" rel="stylesheet" />
    <link href="~/Content/IntegralUI-TreeViewCheckBox/integralui.checkbox.css" rel="stylesheet" />
    <link href="~/Content/IntegralUI-TreeViewCheckBox/integralui.treeview.css" rel="stylesheet" />
    <link href="~/Content/IntegralUI-TreeViewCheckBox/theme-flat-blue.css" rel="stylesheet" id="theme" />
    <script src="~/Scripts/jquery-1.10.2.min.js"></script>
    <script src="~/Scripts/IntegralUI-TreeViewCheckBox/theme.selector.min.js"></script>
    <script src="~/Scripts/angularJs/angular.js"></script>
    <script src="~/Scripts/IntegralUI-TreeViewCheckBox/angular.integralui.min.js"></script>
    <script src="~/Scripts/IntegralUI-TreeViewCheckBox/angular.integralui.lists.min.js"></script>
    <script src="~/Scripts/IntegralUI-TreeViewCheckBox/angular.integralui.checkbox.min.js"></script>
    <script src="~/Scripts/IntegralUI-TreeViewCheckBox/angular.integralui.treeview.min.js"></script>
    <title>菜单权限设置</title>
    <style type="text/css">
        .iui-treeview-item-content {
            padding: 4px;
        }

        .iui-checkbox-box {
            border: 0;
            width: 16px;
            height: 16px;
        }

        .iui-checkbox-checked {
            background-image: url('../../Content/resources/checkbox/checkbox-checked.png');
        }

        .iui-checkbox-unchecked {
            background-image: url('../../Content/resources/checkbox/checkbox-unchecked.png');
        }

        .iui-checkbox-indeterminate {
            background-image: url('../../Content/resources/checkbox/checkbox-indeterminate.png');
        }

        .feature-content {
            width: 500px;
        }

        .directive {
            height: 600px;
            width:260px
        }

        .control-panel {
            margin-left: 35px;
            width: 250px;
        }
    </style>
</head>
<body ng-app="appModule" ng-controller="appCtrl">
        <div class="feature">
            <div class="feature-content">
                <iui-treeview name="{{treeName}}" class="directive" items="items" item-icon="itemIcon" show-check-boxes="true" checkbox-settings="checkBoxSettings" item-checkstate-changing="itemCheckStateChanging(e)"></iui-treeview>
                <button ng-click="refresh()">重新加载</button>
            </div>
        </div>
   
    <script type="text/javascript">
        var appModule = angular.module("appModule", ["integralui"]);
        appModule.controller("appCtrl", ["$scope", "$http", "$timeout", "IntegralUITreeViewService", function ($scope, $http, $timeout, $treeService) {
            $scope.treeName = "treeSample";
            $scope.itemIcon = "icons-medium empty-doc";
            $scope.checkStates = ['checked', 'indeterminate', 'unchecked'];
            $scope.currentState = 'checked';
            $scope.checkList = [];
            ////-----jquery 同步获取数据--------
            $.ajaxSetup({
                async: false
            });
            $.post("/MenuManager/GetData", function (data) {
                $scope.items = data;
            })
            $.ajaxSetup({
                async: true
            });
            ////-----jquery 同步获取数据--------

            initTheme($scope, $treeService, $scope.treeName);
            //var initTimer = $timeout(function () {
            //    $treeService.updateCheckValues($scope.treeName);
            //    $timeout.cancel(initTimer);
            //}, 1);

            $scope.checkBoxSettings = {
                autoCheck: true,
                threeState: true
            }
            $scope.itemCheckStateChanging = function (e) {
                if (e.value == 'unchecked')
                    e.item.checkState = 'checked';
            }
            //刷新数据
            $scope.refresh = function () {
               // $treeService.selectedItem($scope.treeName, $scope.items[0]);//选中某个项目
                $treeService.updateView($scope.treeName);
                $treeService.updateCheckValues($scope.treeName);
            }

        }]);
    </script>
</body>
</html>
